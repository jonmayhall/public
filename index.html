<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>myKaarma – Interactive Training Checklist</title>

  <!-- Cache-buster -->
  <link rel="stylesheet" href="style.css?v=7" />
</head>

<body>
  <div id="app">
    <!-- Sidebar -->
    <aside id="sidebar">
      <div class="sidebar-header">
        <img src="mykaarma_logo.png" alt="myKaarma logo" class="logo" />
      </div>
      <nav>
        <button class="nav-btn" data-target="pretraining">Pre-Training Checklist</button>
        <button class="nav-btn" data-target="dealership-info">Dealership Information</button>
        <button class="nav-btn" data-target="training-checklist">Training Checklist</button>
        <button class="nav-btn" data-target="opcodes">Opcodes & Pricing</button>
        <button class="nav-btn" data-target="dms-integration">DMS Integration</button>
        <button class="nav-btn" data-target="workflow">Workflow Notifications</button>
        <button class="nav-btn" data-target="training-summary">Training Summary</button>
      </nav>
    </aside>

    <!-- Main Content -->
    <main id="content">
      <!-- === PRE-TRAINING CHECKLIST === -->
      <section id="pretraining" class="page-section active">
        <h1>Pre-Training Checklist</h1>
        <div class="section-block">
          <h2>Handoff Notes</h2>
          <div class="checklist-row"><label>Deployment handoff?</label><select><option></option><option>Yes</option><option>No</option><option>N/A</option></select></div>
          <div class="checklist-row"><label>ServiceCart handoff?</label><select><option></option><option>Yes</option><option>No</option><option>N/A</option></select></div>
          <div class="checklist-row"><label>Scheduler handoff?</label><select><option></option><option>Yes</option><option>No</option><option>N/A</option></select></div>
        </div>

        <div class="section-block">
          <h2>Additional Comments</h2>
          <textarea placeholder="Type here…"></textarea>
        </div>
      </section>

      <!-- === DEALERSHIP INFORMATION === -->
      <section id="dealership-info" class="page-section">
        <h1>Dealership Information</h1>

        <div class="section-block">
          <h2>Wi-Fi Information</h2>
          <div class="checklist-row"><label>Wi-Fi Name</label><input type="text" placeholder="Enter Wi-Fi name…" /></div>
          <div class="checklist-row"><label>Wi-Fi Password</label><input type="text" placeholder="Enter password…" /></div>
        </div>

        <div class="section-block">
          <h2>Additional Comments</h2>
          <textarea placeholder="Type here…"></textarea>
        </div>
      </section>

      <!-- === TRAINING CHECKLIST === -->
      <section id="training-checklist" class="page-section">
        <h1>Training Checklist</h1>
        <div id="tables-container"></div>
      </section>
    </main>
  </div>

  <button id="pdfButton" class="floating-btn">Save as PDF</button>

  <!-- Script with cache-buster -->
  <script src="script.js?v=7"></script>

  <script>
  // === Sidebar Navigation ===
  document.querySelectorAll(".nav-btn").forEach((btn) => {
    btn.addEventListener("click", () => {
      const target = btn.getAttribute("data-target");
      document.querySelectorAll(".page-section").forEach((sec) => sec.classList.remove("active"));
      document.getElementById(target).classList.add("active");
      window.scrollTo({ top: 0 });
    });
  });

  // === Dynamic Table Generation ===
  const roles = [
    {
      id: "technicians",
      title: "Technicians – Checklist",
      rows: 3,
      cols: ["DMS ID","Login","Workflow","Mobile App Menu","Search Bar","RO Assignment","Dispatch","RO History","Prev. Declines","OCR","Edit ASR","ShopChat / Parts","Adding Media","Status Change","Notifications","Filters"]
    },
    {
      id: "advisors",
      title: "Service Advisors – Checklist",
      rows: 3,
      cols: ["DMS ID","Login","Mobile App Menu","MCI","Workflow","Search Bar","RO Assignment","DMS History","Prev. Declines","OCR","Edit ASR","ShopChat","Status Change","MPI Send","SOP"]
    },
    {
      id: "parts",
      title: "Parts Representatives – Checklist",
      rows: 2,
      cols: ["DMS ID","Login","Web App","Workflow","Search Bar","Take Function","DMS History","Prev. Declines","Parts Tab","SOP","Edit ASR","ShopChat / Parts","Status Change","Notifications","Filters"]
    },
    {
      id: "bdc",
      title: "BDC Representatives – Checklist",
      rows: 2,
      cols: ["DMS ID","Login","Scheduler","Declined Services","ServiceConnect","Call Routing"]
    },
    {
      id: "pickup",
      title: "Pick Up & Delivery Drivers – Checklist",
      rows: 2,
      cols: ["DMS ID","Login","PU&D","Notifications"]
    }
  ];

  const tablesContainer = document.getElementById("tables-container");
  roles.forEach((role) => {
    const section = document.createElement("div");
    section.classList.add("section");
    section.innerHTML = `
      <div class="section-header">${role.title}</div>
      <div class="table-wrapper">
        <div class="table-scroll">
          <table id="${role.id}" class="training-table">
            <thead>
              <tr>
                <th>Name</th>
                ${role.cols.map(c => `<th>${c}</th>`).join("")}
              </tr>
            </thead>
            <tbody>
              ${Array.from({ length: role.rows }).map(() => `
                <tr>
                  <td><input type="text" placeholder="Name" /></td>
                  ${role.cols.map(() => `
                    <td>
                      <select>
                        <option></option>
                        <option value="Yes">Yes</option>
                        <option value="Web Only">Web Only</option>
                        <option value="Mobile Only">Mobile Only</option>
                        <option value="No">No</option>
                        <option value="Not Trained">Not Trained</option>
                        <option value="N/A">N/A</option>
                      </select>
                    </td>`).join("")}
                </tr>`).join("")}
            </tbody>
          </table>
        </div>
        <div class="table-footer">
          <div class="add-row" data-target="${role.id}">+</div>
        </div>
      </div>
      <div class="section-block comment-box"><h2>Additional Comments</h2><textarea placeholder="Type here…"></textarea></div>
    `;
    tablesContainer.appendChild(section);
  });

  // === Add Row Button ===
  document.addEventListener("click", (e) => {
    if (e.target.classList.contains("add-row")) {
      const id = e.target.dataset.target;
      const table = document.getElementById(id);
      const first = table.querySelector("tbody tr");
      const clone = first.cloneNode(true);
      clone.querySelectorAll("input").forEach((i) => (i.value = ""));
      clone.querySelectorAll("select").forEach((s) => {
        s.selectedIndex = 0;
        s.style.backgroundColor = "#f3f3f3";
      });
      table.querySelector("tbody").appendChild(clone);
    }
  });

  // === Dropdown Colors ===
  function colorSelect(sel) {
    const v = sel.value;
    const colors = {
      "Yes": "#c9f7c0",
      "Web Only": "#fff8b3",
      "Mobile Only": "#ffe0b3",
      "No": "#ffb3b3",
      "Not Trained": "#ffb3b3",
      "N/A": "#f2f2f2"
    };
    sel.style.backgroundColor = colors[v] || "#f3f3f3";
  }
  document.addEventListener("change", (e) => {
    if (e.target.tagName === "SELECT") colorSelect(e.target);
  });

  // === Expanding Textareas ===
  document.addEventListener("input", (e) => {
    if (e.target.tagName === "TEXTAREA") {
      e.target.style.height = "auto";
      e.target.style.height = e.target.scrollHeight + "px";
    }
  });
  </script>
</body>
</html>
